# 行为树

> 行为树 Behavior Tree 的概念最早来源 halo 这款游戏里的 ai 控制结构，它通过类似于决策树的树形决策结构来选择当前环境下应该做出的具体行为。

由于行为树在描述复杂逻辑时比 [[状态机]] 更容易理解，所以在机器人领域目为了实现复杂的机器行为也引入的行为树。

## 行为树的基本特点

采用树形结构描述，由根（root）出发执行树上的节点。一般有几种不同的节点。采用 [[深度优先DFS]] 方式遍历

### 节点类型

0. root 根节点
1. Control 控制节点
2. Action 动作节点
3. Decorator 装饰器节点

> [!tips]
> - Control 节点有一个父节点，和至少一个子节点
> - Decorator 只有一个父节点和一个子节点
> - 所有的叶节点 都只能是 Action 节点

### 节点状态

- *SUCCESS* 控制节点条件已满足，或者动作已经执行完成
- *RUNNING* 动作节点已经初始化完成，但是等待执行结束
- *FAILURE* 控制节点条件不满足，或者动作节点无法完成动作
- *ERROR* 发生未知错误，正常情况下不能出现 *ERROR* 状态

### 优点

- 分层
- 树形结构
- 无限执行

### 缺点

- 总是从 root 开始
- 没有全局的动作

## [[行为树]] VS [[状态机]]

![[Pasted image 20221019115426.png]]

## 行为树软件库

- Python [py_trees](https://github.com/splintered-reality/py_trees)
- C++ [[BehaviorTree.CPP]]


